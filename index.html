<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ledgerly - Business Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet">
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        // Dark Theme Colors
                        'primary': '#4f46e5',
                        'primary-hover': '#4338ca',
                        'secondary': '#1f2937',
                        'secondary-hover': '#374151',
                        'background': '#111827',
                        'surface': '#1f2937',
                        'text-primary': '#f9fafb',
                        'text-secondary': '#d1d5db',
                        'accent': '#34d399',
                        'danger': '#ef4444',
                        // Sepia Light Theme Colors
                        'sepia-bg': '#fdf6e3',
                        'sepia-surface': '#fbf1c7',
                        'sepia-text': '#654321', // Dark Brown
                        'sepia-text-secondary': '#8b5e34', // Lighter Brown
                        'sepia-primary': '#a16207', // Amber-700
                        'sepia-primary-hover': '#854d0e', // Amber-800
                        'sepia-border': '#d7c095',
                        'sepia-accent': '#16a34a', // Green-600
                        'sepia-danger': '#dc2626', // Red-600
                    },
                    keyframes: {
                        'fade-in-out': {
                            '0%': { opacity: '0', transform: 'translateY(-20px)' },
                            '10%': { opacity: '1', transform: 'translateY(0)' },
                            '90%': { opacity: '1', transform: 'translateY(0)' },
                            '100%': { opacity: '0', transform: 'translateY(-20px)' },
                        }
                    },
                    animation: {
                        'fade-in-out': 'fade-in-out 4s ease-in-out forwards',
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background-color: #fdf6e3; /* sepia-bg */
            color: #654321; /* sepia-text */
        }
        .modal-backdrop { background-color: rgba(0, 0, 0, 0.6); }
        .tab-button.active { background-color: #a16207; color: white; }
        .task-completed { text-decoration: line-through; color: #a3a3a3; }
        .prose { color: #654321; }
        .dark body { background-color: #111827; color: #f9fafb; }
        .dark .tab-button.active { background-color: #4f46e5; }
        .dark .prose { color: #f9fafb; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #fbf1c7; }
        .dark ::-webkit-scrollbar-track { background: #1f2937; }
        ::-webkit-scrollbar-thumb { background: #d7c095; border-radius: 4px; }
        .dark ::-webkit-scrollbar-thumb { background: #4a5568; }
        ::-webkit-scrollbar-thumb:hover { background: #8b5e34; }
        .dark ::-webkit-scrollbar-thumb:hover { background: #718096; }
    </style>
</head>
<body class="antialiased font-sans">
    <!-- ... your HTML content here, unchanged ... (from your code above) ... -->

    <!-- The entire large HTML structure is unchanged up to the end of your last script tag! -->
    
<script>
document.addEventListener('DOMContentLoaded', () => {

    const app = {
        // ... all your existing code above remains unchanged ...

        // Insert all your previous app code here
        // DO NOT REMOVE OR CHANGE ANYTHING ABOVE THIS POINT

        async mockGeminiAPI(name, revenue, expenses, profit, transactions) {
            return new Promise(resolve => setTimeout(() => {
                const advice = [];
                if (profit < 0) advice.push(`- **Address Negative Profit:** The current net profit is -$${Math.abs(profit).toFixed(2)}. Prioritize cost reduction or boosting high-margin sales immediately.`);
                else advice.push(`- **Leverage Positive Profit:** With a net profit of $${profit.toFixed(2)}, consider reinvesting in top-selling products or marketing efforts to scale up.`);

                // Add dummy advice listing recent transactions
                advice.push("- **Recent Transactions:**");
                advice.push(transactions.map(t => `    - ${t}`).join('\n'));
                resolve([
                    `### Profit Plan for ${name}`,
                    "",
                    `- **Revenue:** $${revenue.toFixed(2)}`,
                    `- **Expenses:** $${expenses.toFixed(2)}`,
                    `- **Net Profit:** $${profit.toFixed(2)}`,
                    "",
                    ...advice
                ].join('\n'));
            }, 1500));
        },
        simpleMarkdownToHtml(md) {
            return md.replace(/### (.+)/g, '<h3>$1</h3>')
                     .replace(/^- \*\*(.+?)\*\*: (.+)$/gm, '<p><strong>$1:</strong> $2</p>')
                     .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                     .replace(/- (.+)/g, '<li>$1</li>')
                     .replace(/\n/g, '');
        }
    };

    window.app = app;
    app.init();
});
</script>
</body>
</html>
